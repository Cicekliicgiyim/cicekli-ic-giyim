<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Giriş Yap - Çiçekli İç Giyim</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>Çiçekli İç Giyim</h1>
    <nav>
      <a href="index.html">Anasayfa</a>
      <a href="register.html">Kayıt Ol</a>
      <span id="user-info" style="margin-left: 10px;"></span>
      <button id="logoutBtn" style="display: none; margin-left: 10px;">Çıkış Yap</button>
    </nav>
  </header>

  <main style="padding: 40px;">
    <h2>Giriş Yap</h2>
    <form id="loginForm">
      <label for="email">E-posta:</label><br>
      <input type="email" id="email" required><br><br>

      <label for="password">Şifre:</label><br>
      <input type="password" id="password" required><br><br>

      <button type="submit">Giriş Yap</button>
      <p id="error-message" style="color: red; display: none;">Geçersiz e-posta veya şifre!</p>
    </form>
  </main>

  <footer>
    <p>&copy; 2025 Çiçekli İç Giyim</p>
  </footer>

  <script>
    document.getElementById("loginForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      const users = JSON.parse(localStorage.getItem("users")) || [];
      const user = users.find(u => u.email === email && u.password === password);

      const errorMessage = document.getElementById("error-message");

      if (user) {
        localStorage.setItem("loggedInUser", JSON.stringify(user));
        alert("Giriş başarılı!");

        if (user.role === "admin") {
          window.location.href = "admin.html";  // Admin paneline yönlendir
        } else {
          window.location.href = "index.html";  // Ana sayfaya yönlendir
        }
      } else {
        errorMessage.style.display = "block";  // Hata mesajını göster
      }
    });

    // Oturum kontrolü ve kullanıcı adı gösterme
    window.addEventListener("DOMContentLoaded", () => {
      const user = JSON.parse(localStorage.getItem("loggedInUser"));
      const userInfo = document.getElementById("user-info");
      const logoutBtn = document.getElementById("logoutBtn");

      if (user) {
        userInfo.textContent = `${user.name} olarak giriş yapıldı`;
        logoutBtn.style.display = "inline-block";

        logoutBtn.addEventListener("click", () => {
          localStorage.removeItem("loggedInUser");
          window.location.reload();
        });
      }
    });
  </script>
</body>
</html>
